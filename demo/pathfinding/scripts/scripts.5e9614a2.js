"use strict";angular.module("pathfindingApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","vds.dijkstra"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/debug",{templateUrl:"views/debug.html",controller:"DebugCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("pathfindingApp").factory("graphData",function(){var a=[{points:[{id:0,style:{left:89,top:433},x:92,y:436},{id:1,style:{left:254,top:96},x:257,y:99},{id:2,style:{left:329,top:67},x:332,y:70},{id:3,style:{left:99,top:411},x:102,y:414},{id:4,style:{left:134,top:411},x:137,y:414},{id:5,style:{left:173,top:350},x:176,y:353},{id:6,style:{left:205,top:349},x:208,y:352},{id:7,style:{left:145,top:411},x:148,y:414},{id:8,style:{left:147,top:405},x:150,y:408},{id:9,style:{left:171,top:361},x:174,y:364},{id:10,style:{left:238,top:349},x:241,y:352},{id:11,style:{left:259,top:314},x:262,y:317},{id:12,style:{left:291,top:313},x:294,y:316},{id:13,style:{left:283,top:313},x:286,y:316},{id:14,style:{left:299,top:316},x:302,y:319},{id:15,style:{left:372,top:313},x:375,y:316},{id:16,style:{left:377,top:321},x:380,y:324},{id:17,style:{left:323,top:207},x:326,y:210},{id:18,style:{left:323,top:185},x:326,y:188},{id:19,style:{left:303,top:198},x:306,y:201},{id:20,style:{left:285,top:165},x:288,y:168},{id:21,style:{left:267,top:130},x:270,y:133},{id:22,style:{left:350,top:259},x:353,y:262},{id:23,style:{left:357,top:280},x:360,y:283},{id:24,style:{left:427,top:443},x:430,y:446},{id:25,style:{left:414,top:321},x:417,y:324},{id:26,style:{left:435,top:284},x:438,y:287},{id:27,style:{left:473,top:283},x:476,y:286},{id:28,style:{left:493,top:393},x:496,y:396},{id:29,style:{left:518,top:347},x:521,y:350},{id:30,style:{left:439,top:465},x:442,y:468},{id:31,style:{left:375,top:214},x:378,y:217},{id:32,style:{left:625,top:409},x:628,y:412},{id:33,style:{left:629,top:388},x:632,y:391},{id:34,style:{left:392,top:174},x:395,y:177},{id:35,style:{left:410,top:392},x:413,y:395},{id:36,style:{left:78,top:428},x:81,y:431,name:"Prehistory of Florida"},{id:37,style:{left:83,top:376},x:86,y:379,name:"Center for Florida History"},{id:38,style:{left:243,top:55},x:246,y:58,name:"Bouchelle Center of Decorative Arts"},{id:39,style:{left:267,top:69},x:270,y:72,name:"Bouchelle Gallery"},{id:40,style:{left:134,top:417},x:137,y:420,name:"Gillespy Gallery"},{id:41,style:{left:141,top:401},x:144,y:404,name:"Male Restroom"},{id:42,style:{left:164,top:357},x:167,y:360,name:"Female Restroom"},{id:43,style:{left:169,top:341},x:172,y:344,name:"Planetarium"},{id:44,style:{left:205,top:367},x:208,y:370,name:"William Childrens Wing"},{id:45,style:{left:247,top:349},x:250,y:352,name:"The Cuban Museum"},{id:46,style:{left:252,top:310},x:255,y:313,name:"Marzullo Gallery"},{id:47,style:{left:284,top:295},x:287,y:298,name:"Karshan Gallery"},{id:48,style:{left:338,top:327},x:341,y:330,name:"Lobby"},{id:49,style:{left:338,top:363},x:341,y:366,name:"Entrance"},{id:50,style:{left:295,top:200},x:298,y:203,name:"Male Restroom"},{id:51,style:{left:278,top:167},x:281,y:170,name:"Female Restroom"},{id:52,style:{left:259,top:135},x:262,y:138,name:"Ford Gallery"},{id:53,style:{left:272,top:100},x:275,y:103,name:"The Dow Gallery of American Art"},{id:54,style:{left:363,top:275},x:366,y:278,name:"Entrance"},{id:55,style:{left:243,top:103},x:246,y:106,name:"Ford Gallery"},{id:56,style:{left:368,top:207},x:371,y:210,name:"Museum Store"},{id:57,style:{left:575,top:462},x:578,y:465,name:"The Root Family Museum"},{id:58,style:{left:639,top:379},x:642,y:382,name:"Train Station"},{id:59,style:{left:364,top:119},x:367,y:122,name:"Schulte Gallery of Chinese Art"},{id:60,style:{left:489,top:314},x:492,y:317,name:"Chapman Root Hall Auditorium"},{id:61,style:{left:395,top:347},x:398,y:350,name:"Root Hall Gallery"},{id:"62",style:{left:449,top:408},x:452,y:411}],bridges:{0:{3:24.166091947189145,36:12.083045973594572},1:{21:36.40054944640259,39:29.966648127543394,53:18.439088914585774,55:13.038404810405298},2:{39:62.03224967708329,59:62.68173577685928},3:{0:24.166091947189145,4:35,37:38.48376280978771},4:{3:35,7:11,40:6},5:{6:32.01562118716424,9:11.180339887498949,43:9.848857801796104},6:{5:32.01562118716424,9:36.05551275463989,10:33,44:18},7:{4:11,8:6.324555320336759},8:{7:6.324555320336759,9:50.11985634456667,41:7.211102550927978},9:{5:11.180339887498949,6:36.05551275463989,8:50.11985634456667,42:8.06225774829855},10:{6:33,11:40.8166632639171,45:9},11:{10:40.8166632639171,13:24.020824298928627,46:8.06225774829855},12:{13:8,14:8.54400374531753},13:{11:24.020824298928627,12:8,47:18.027756377319946},14:{12:8.54400374531753,48:40.52159917870962},15:{16:9.433981132056603,23:36.24913792078372,48:36.76955262170047},16:{15:9.433981132056603,25:37,61:31.622776601683793},17:{18:22,19:21.93171219946131,22:58.59180830116101},18:{17:22,19:23.853720883753127},19:{17:21.93171219946131,18:23.853720883753127,20:37.589892258425,50:8.246211251235321},20:{19:37.589892258425,21:39.35733730830886,51:7.280109889280518},21:{1:36.40054944640259,20:39.35733730830886,52:9.433981132056603},22:{17:58.59180830116101,23:22.135943621178654,31:51.478150704935004},23:{15:36.24913792078372,22:22.135943621178654,48:50.695167422546305,54:7.810249675906654},24:{30:25.059928172283335,35:53.75872022286245,62:41.340053217188775},25:{16:37,26:42.5440947723653,61:32.202484376209235},26:{25:42.5440947723653,27:38.01315561749642},27:{26:38.01315561749642,60:34.88552708502482},28:{29:52.354560450833695,35:83.00602387778854,62:46.486557196677836},29:{28:52.354560450833695,60:43.93176527297759},30:{24:25.059928172283335,57:136.03308421115798},31:{22:51.478150704935004,34:43.46262762420146,56:9.899494936611665},32:{33:21.37755832643195,57:72.86288492778748},33:{32:21.37755832643195,58:13.45362404707371},34:{31:43.46262762420146,59:61.71709649683789},35:{24:53.75872022286245,28:83.00602387778854,61:47.43416490252569,62:42.15447781671598},36:{0:12.083045973594572},37:{3:38.48376280978771},38:{39:27.784887978899608},39:{1:29.966648127543394,2:62.03224967708329,38:27.784887978899608},40:{4:6},41:{8:7.211102550927978},42:{9:8.06225774829855},43:{5:9.848857801796104},44:{6:18},45:{10:9},46:{11:8.06225774829855},47:{13:18.027756377319946},48:{14:40.52159917870962,15:36.76955262170047,23:50.695167422546305,49:36},49:{48:36},50:{19:8.246211251235321},51:{20:7.280109889280518},52:{21:9.433981132056603},53:{1:18.439088914585774},54:{23:7.810249675906654},55:{1:13.038404810405298},56:{31:9.899494936611665},57:{30:136.03308421115798,32:72.86288492778748},58:{33:13.45362404707371},59:{2:62.68173577685928,34:61.71709649683789},60:{27:34.88552708502482,29:43.93176527297759},61:{16:31.622776601683793,25:32.202484376209235,35:47.43416490252569},62:{24:41.340053217188775,28:46.486557196677836,35:42.15447781671598}}}],b=49;return{getMap:function(b){return a[b]},setMap:function(b,c){a[b]=c},getPointsByName:function(b,c){for(var d=[],e=0;e<a[b].points.length;e++)a[b].points[e].name==c&&d.push(a[b].points[e]);return d},getPointById:function(b,c){for(var d=0;d<a[b].points.length;d++)if(a[b].points[d].id==c)return a[b].points[d];return void 0},getPointsByIds:function(b,c){for(var d,e=[],f=0;f<a[b].points.length;f++)d=c.indexOf(a[b].points[f].id+""),d>-1&&(e[d]=a[b].points[f]);return e},getStartingPoint:function(){return b},setStartingPoint:function(a){console.log(a),b=a}}}),angular.module("pathfindingApp").controller("DebugCtrl",["$scope","graphData","vdsDijkstra",function(a,b,c){a.points=[],a.bridges={},a.path=[],a.selectedPoint=void 0,a.bridgeMode=!1,a.onPin=function(b){if(!a.bridgeMode){var c={id:a.points.length+"",style:{left:b.pageX-3,top:b.pageY-3},x:b.pageX,y:b.pageY};a.points.push(c),a.selectedPoint=c}},a.pinClick=function(d){if(b.setStartingPoint(d.id),a.bridgeMode){if("undefined"==typeof a.selectedPoint||a.selectedPoint==d)return;if(a.bridges[a.selectedPoint.id]=a.bridges[a.selectedPoint.id]||{},"undefined"==typeof a.bridges[a.selectedPoint.id][d.id]){var e=a.selectedPoint,f=d.x-e.x,g=d.y-e.y,h=Math.sqrt(f*f+g*g);a.bridges[d.id]=a.bridges[d.id]||{},a.bridges[a.selectedPoint.id][d.id]=h,a.bridges[d.id][a.selectedPoint.id]=h}else delete a.bridges[a.selectedPoint.id][d.id],delete a.bridges[d.id][a.selectedPoint.id]}else a.selectedPoint&&a.travel(a.selectedPoint.id,d.id),a.selectedPoint=d;a.bridgeGraph=new c(a.bridges)},a.deletePin=function(b){for(var c=0;c<a.points.length;c++)if(b==a.points[c]){a.points.splice(c,1),a.selectedPoint=void 0;break}},a["export"]=function(){for(var c=[],d=0;d<a.points.length;d++)c.push({id:a.points[d].id,style:a.points[d].style,x:a.points[d].x,y:a.points[d].y,name:a.points[d].name});var e={points:c,bridges:a.bridges};b.setMap(0,e),console.log(JSON.stringify(e))},a.travel=function(b,c){return a.path=a.bridgeGraph.findShortestPath(b+"",c+""),a.path},window.travel=function(b,c){a.travel(b,c),a.$apply();for(var d=0;d<a.points.length;d++)a.points[d].id+""==a.path[a.path.length-1]&&(a.selectedPoint=a.points[d]);return a.path},a.inPath=function(b){if(a.path){var c=a.path.indexOf(b+"")>-1;return c}};var d=b.getMap(0);a.points=d.points,a.bridges=d.bridges,a.bridgeGraph=new c(d.bridges)}]),angular.module("pathfindingApp").controller("MainCtrl",["$scope","graphData","vdsDijkstra",function(a,b,c){TweenLite.from($(".sidepanel"),1,{alpha:0}),TweenLite.from($(".mainpanel"),1,{alpha:0,delay:.5});var d,e,f,g,h=1200,i=833,j=807;a.places=[],a.selectedPlace=void 0,a.mapData=b.getMap(0),a.renderer=new PIXI.CanvasRenderer(h,i),a.container=document.getElementsByClassName("canvas-container")[0],a.container.appendChild(a.renderer.view),a.stage=new PIXI.Stage(16777215),a.scaleCanvas=function(){var b=a.container.getBoundingClientRect().width;a.renderer.view.width=b,a.renderer.view.height=b/h*i},$(window).resize(function(){a.$apply(function(){a.scaleCanvas()})}),a.getPlaces=function(){a.places=[];for(var b=0;b<a.mapData.points.length;b++)"undefined"!=typeof a.mapData.points[b].name&&-1==a.places.indexOf(a.mapData.points[b].name)&&a.places.push(a.mapData.points[b].name)},a.placeHover={speed:.35,prop:{paddingLeft:"10px",backgroundColor:"#e17a1e",color:"#fff"}},a.placeHoverOut={speed:.5,prop:{paddingLeft:"5px",backgroundColor:"transparent",color:"rgb(51,51,51)"}},a.placeClick=function(d){a.selectedPlace=d;var e,f=b.getPointsByName(0,d)[0],k=c.findShortestPath(b.getMap(0).bridges,b.getStartingPoint()+"",f.id+"");TweenLite.to(a.renderer.view,.5,{opacity:1}),TweenLite.to(g,.5,{alpha:0,onComplete:function(){var a=h/j;e=b.getPointsByIds(0,k),g.clear(),g.beginFill(0,0),g.drawRect(0,0,h,i),g.endFill(),g.lineStyle(5,16711680),g.moveTo(0,0),g.beginFill(16711680,1),g.drawCircle(e[0].x*a,e[0].y*a,3*a),g.endFill();for(var c=0;c<e.length;c++)0==c?g.moveTo(e[c].x*a,e[c].y*a):g.lineTo(e[c].x*a,e[c].y*a);g.beginFill(16711680,1),g.drawCircle(e[c-1].x*a,e[c-1].y*a,3*a),g.endFill(),TweenLite.to(g,.75,{alpha:1})}})},a.resetMap=function(){TweenLite.to(a.renderer.view,.5,{opacity:0,onComplete:function(){g.clear()}})},e=PIXI.Texture.fromImage("http://val-samonte.github.io/img/gray-map.png"),f=new PIXI.Sprite(e),g=new PIXI.Graphics,a.stage.addChild(f),a.stage.addChild(g),d=function(){g.width=f.width=a.renderer.view.width,g.height=f.height=a.renderer.view.height,g.position.x=f.position.x=0,g.position.y=f.position.y=0,a.renderer.render(a.stage),requestAnimationFrame(d)},requestAnimationFrame(d),a.getPlaces(),a.scaleCanvas()}]),angular.module("pathfindingApp").directive("onHover",function(){return{restrict:"A",scope:{onHover:"=",offHover:"="},link:function(a,b){b.hover(function(){TweenLite.to(this,a.onHover.speed,a.onHover.prop)},function(){TweenLite.to(this,a.offHover.speed,a.offHover.prop)})}}});
