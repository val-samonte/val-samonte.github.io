"use strict";angular.module("timelogApp",["ngAnimate","ngSanitize","ngTouch","vds.multirange","monospaced.mousewheel","ui.bootstrap"]),angular.module("timelogApp").controller("MainCtrl",["$scope","vdsMultirangeViews","vdsUtils",function(a,b,c){a.data_logs={},a.data_ref=[],a.slider={views:b.TIME,view:0},a.changeSliderView=function(b,c){var d=a.slider.view+c;0>d?d=0:d>=a.slider.views.length&&(d=a.slider.views.length-1),a.slider.view=d},a.onDateSelect=function(b){"undefined"!=typeof b&&("undefined"==typeof a.data_logs[b]&&(a.data_logs[b]=[]),a.data_ref=a.data_logs[b])},a.addEntry=function(b,d,e,f){var g=new Date(d+" "+e);"Invalid Date"!=g&&("Start Break"==b?f().then(function(d){a.data_ref.push({name:b,reason:d,value:c.time.fromTimeToValue(g.getHours(),g.getMinutes())})}):a.data_ref.push({name:b,value:c.time.fromTimeToValue(g.getHours(),g.getMinutes())}))},a.convert=function(a){var b=c.time.fromValueToTime(a);return b.hours+":"+c.format.padZeroes(b.minutes,2)},a.onDateSelect((new Date).toString().split(" ").splice(0,4).join(" "),0)}]),angular.module("timelogApp").directive("timeWidget",["$interval","$filter",function(a,b){return{templateUrl:"views/templates/timewidget.html",restrict:"E",scope:{target:"=date",timer:"=time",onDateSelect:"="},link:function(c){c.toDay=function(a){return a.toString().split(" ").splice(0,4).join(" ")},c.tick=function(){c.date.setSeconds(c.date.getSeconds()+1),c.target==c.toDay(c.date)?(c.timer=b("date")(c.date,"HH:mm:ss"),c.day=b("date")(c.date,"MMM dd, yyyy")):(c.timer=c.entry_hour+":"+c.entry_minute+":00",c.day=b("date")(new Date(c.target),"MMM dd, yyyy"))},c.toggleCalendar=function(){c.showCalendarFlag=!c.showCalendarFlag},c.hideCalendar=function(){c.target=c.toDay(new Date(c.datePicker)),c.target!=c.toDay(c.date)&&(c.timer=c.entry_hour+":"+c.entry_minute+":00",c.day=b("date")(new Date(c.target),"MMM dd, yyyy")),c.showCalendarFlag=!1,c.onDateSelect(c.target,c.timer)},c.$watch("datePicker",function(a){"undefined"!=typeof a&&c.hideCalendar()}),c.date=new Date,c.target=c.toDay(c.date),c.tickPromise=a(c.tick,1e3),c.tick()}}}]),angular.module("timelogApp").directive("stepper",function(){return{templateUrl:"views/templates/stepper.html",restrict:"E",required:"ngModel",scope:{ngModel:"=",min:"=",max:"="},link:function(a){a.$watch("ngModel",function(){a.ngModel<a.min&&(a.ngModel=a.min),a.ngModel>a.max&&(a.ngModel=a.max)}),a.stepUp=function(){a.ngModel++},a.stepDown=function(){a.ngModel--},a.ngModel=0}}}),angular.module("timelogApp").directive("reasonModal",["$q",function(a){return{templateUrl:"views/templates/reasonmodal.html",restrict:"E",scope:{show:"="},link:function(b){b.id="reasonmodal",b.show=function(){return $("#"+b.id).modal({keyboard:!1,backdrop:"static",show:!0}),b.deferred=a.defer(),b.deferred.promise},b.cancel=function(){$("#"+b.id).modal("hide"),b.deferred.reject()},b.submit=function(a){"string"==typeof a&&""!=a&&($("#"+b.id).modal("hide"),b.deferred.resolve(a))}}}}]);
